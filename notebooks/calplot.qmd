```{python}
from queries_db import show_tables, query as qu
from queries_db.constants import get_tables_by_year
import pyprojroot
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
from matplotlib.font_manager import fontManager, FontProperties
import calplot


root_path = pyprojroot.here()
helvetica_path = root_path / 'fonts' / 'Helvetica.ttf'

fontManager.addfont(helvetica_path)
```

```{python}
year: int = 2025
tables_db = get_tables_by_year(year)
```

```{python}
union_query = "\nUNION ALL\n".join([f"SELECT date_id FROM {monthy}" for monthy in tables_db])

kog_date_query = f"""
WITH calendar_fact AS (
    {union_query}
)
SELECT c.ndmax, COUNT(ndmax) AS jugadores
FROM calendar_fact f 
INNER JOIN calendar_{year} c ON f.date_id = c.date_id
GROUP BY ndmax
ORDER BY ndmax;
"""

kog_date = qu(kog_date_query)
kog_date.index = pd.to_datetime(f'{year}-01-01') + pd.to_timedelta(kog_date.index, unit='D')

calplot.calplot(
    kog_date['jugadores'],
    cmap = 'Spectral_r', yearascending = False,
    suptitle=f'Jugadores por DÃ­a en {year}',
)

plt.show()
```

```{python}
from plotly_calplot import calplot


fig = calplot(
    kog_date,
    x="ndmax",
    y="jugadores"
)

fig.show()
```


```{python}
print('hola')
```